# DWAPCBCè·¯å¾„è§„åˆ’ç³»ç»Ÿ

**Dynamic Waypoint Allocation Piecewise Cubic Bezier Curve (DWAPCBC)** - å•†ä¸šçº§ç§»åŠ¨æœºå™¨äººè·¯å¾„è§„åˆ’è§£å†³æ–¹æ¡ˆ

---

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æ˜¯åŸºäºè®ºæ–‡ã€ŠEnhancing the safety and smoothness of path planning through an integration of Dijkstra's algorithm and piecewise cubic Bezier optimizationã€‹çš„å•†ä¸šçº§å®ç°ï¼Œæä¾›äº†ä¸€å¥—å®Œæ•´çš„ç§»åŠ¨æœºå™¨äººè·¯å¾„è§„åˆ’è§£å†³æ–¹æ¡ˆã€‚

### æ ¸å¿ƒç‰¹æ€§

- âœ… **å®‰å…¨æ€§ä¿éšœ**ï¼šåŠ¨æ€å®‰å…¨é—´éš™æœºåˆ¶ï¼Œç¡®ä¿ä¸éšœç¢ç‰©ä¿æŒå®‰å…¨è·ç¦»
- âœ… **å¹³æ»‘è½¨è¿¹**ï¼šåˆ†æ®µä¸‰æ¬¡è´å¡å°”æ›²çº¿ä¼˜åŒ–ï¼Œä¿è¯CÂ²è¿ç»­æ€§
- âœ… **æ™ºèƒ½ä¼˜åŒ–**ï¼šè‡ªé€‚åº”è·¯å¾„ç‚¹åˆ†é…ï¼Œæ ¹æ®ç¯å¢ƒå¤æ‚åº¦åŠ¨æ€è°ƒæ•´
- âœ… **é«˜æ•ˆè®¡ç®—**ï¼šåŸºäºDijkstraç®—æ³•çš„å…¨å±€æœ€ä¼˜è·¯å¾„æœç´¢
- âœ… **å‘½ä»¤è¡Œå·¥å…·**ï¼šç®€å•æ˜“ç”¨çš„CLIç•Œé¢ï¼Œæ”¯æŒæ‰¹å¤„ç†å’Œäº¤äº’æ¨¡å¼

### æ€§èƒ½æŒ‡æ ‡

æ ¹æ®æ‰¹é‡æµ‹è¯•ç»“æœï¼š
- **æˆåŠŸç‡**ï¼š100%ï¼ˆ3/3åœºæ™¯ï¼‰
- **å¹³å‡å®‰å…¨è·ç¦»**ï¼š1.31 m
- **å¹³å‡å¹³æ»‘åº¦**ï¼š160.56Â°
- **å¹³å‡è®¡ç®—æ—¶é—´**ï¼š1.37 s

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.11+
- ä¾èµ–åŒ…ï¼šnumpy, scipy, matplotlib, pandas, networkx, shapely

### å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
cd /home/ubuntu/dwapcbc-system/backend

# å®‰è£…ä¾èµ–
pip3 install numpy scipy matplotlib pandas networkx shapely
```

### åŸºæœ¬ä½¿ç”¨

#### 1. ä½¿ç”¨é¢„è®¾åœºæ™¯

```bash
# è¿è¡Œç¤ºä¾‹åœºæ™¯1ï¼ˆä¸­ç­‰å¤æ‚åº¦ï¼‰
python3 cli.py -f scenarios/example1.json --no-viz

# è¿è¡Œå¹¶ä¿å­˜å¯è§†åŒ–ç»“æœ
python3 cli.py -f scenarios/example1.json -o output.png --no-viz

# è¿è¡Œé«˜å¯†åº¦éšœç¢ç‰©åœºæ™¯
python3 cli.py -f scenarios/example2.json --no-viz
```

#### 2. æ‰¹é‡æµ‹è¯•

```bash
# æ‰¹é‡è¿è¡Œæ‰€æœ‰åœºæ™¯å¹¶ç”ŸæˆæŠ¥å‘Š
python3 batch_test.py -d scenarios -o batch_results
```

#### 3. è‡ªå®šä¹‰å‚æ•°

```bash
# è¦†ç›–å‚æ•°ï¼šå®‰å…¨ä¼˜å…ˆæ¨¡å¼
python3 cli.py -f scenarios/example1.json --w1 0.7 --w2 0.3 --safety-margin 2.5 --no-viz

# è¦†ç›–å‚æ•°ï¼šå¹³æ»‘ä¼˜å…ˆæ¨¡å¼
python3 cli.py -f scenarios/example1.json --w1 0.4 --w2 0.6 --safety-margin 1.5 --no-viz
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
dwapcbc-system/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ dijkstra.py              # Dijkstraè·¯å¾„æœç´¢ç®—æ³•
â”‚   â”œâ”€â”€ path_optimizer.py        # è·¯å¾„ä¼˜åŒ–æ¨¡å—
â”‚   â”œâ”€â”€ bezier_curve.py          # è´å¡å°”æ›²çº¿ç”Ÿæˆ
â”‚   â”œâ”€â”€ dwapcbc.py              # DWAPCBCæ ¸å¿ƒç®—æ³•
â”‚   â”œâ”€â”€ cli.py                  # å‘½ä»¤è¡Œå·¥å…·
â”‚   â”œâ”€â”€ batch_test.py           # æ‰¹é‡æµ‹è¯•å·¥å…·
â”‚   â”œâ”€â”€ app.py                  # Flask APIæœåŠ¡ï¼ˆå¯é€‰ï¼‰
â”‚   â”œâ”€â”€ scenarios/              # åœºæ™¯é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ example1.json       # ä¸­ç­‰å¤æ‚åº¦åœºæ™¯
â”‚   â”‚   â”œâ”€â”€ example2.json       # é«˜éšœç¢ç‰©å¯†åº¦åœºæ™¯
â”‚   â”‚   â””â”€â”€ example3.json       # ç®€å•ç¯å¢ƒåœºæ™¯
â”‚   â”œâ”€â”€ results/                # å•æ¬¡æµ‹è¯•ç»“æœ
â”‚   â””â”€â”€ batch_results/          # æ‰¹é‡æµ‹è¯•ç»“æœ
â”‚       â”œâ”€â”€ test_results.csv    # CSVæ ¼å¼ç»“æœ
â”‚       â”œâ”€â”€ summary.txt         # æ–‡æœ¬æ‘˜è¦
â”‚       â””â”€â”€ comparison_charts.png # å¯¹æ¯”å›¾è¡¨
â”œâ”€â”€ paper_analysis.md           # è®ºæ–‡åˆ†ææ–‡æ¡£
â”œâ”€â”€ system_architecture.md      # ç³»ç»Ÿæ¶æ„è®¾è®¡
â””â”€â”€ README.md                   # æœ¬æ–‡ä»¶
```

---

## ğŸ”§ æ ¸å¿ƒç®—æ³•

### 1. Dijkstraè·¯å¾„æœç´¢

ä½¿ç”¨Dijkstraç®—æ³•åœ¨åŠ æƒå›¾ä¸­å¯»æ‰¾æœ€çŸ­è·¯å¾„ï¼Œä½œä¸ºåˆå§‹è·¯å¾„ã€‚

**ç‰¹ç‚¹**ï¼š
- ä¿è¯å…¨å±€æœ€ä¼˜
- æ”¯æŒ8è¿é€šæ€§ï¼ˆä¸Šä¸‹å·¦å³+å¯¹è§’çº¿ï¼‰
- è€ƒè™‘å®‰å…¨è£•åº¦çš„éšœç¢ç‰©æ‰©å±•

### 2. è·¯å¾„ä¼˜åŒ–

**æ›²ç‡åˆ†æ**ï¼š
```
Îº = ||v1 Ã— v2|| / ||v1||Â³
```

**è§’åº¦åå·®æ³•**ï¼š
- ç§»é™¤æ¥è¿‘180Â°çš„å†—ä½™ç‚¹
- ä¿ç•™é«˜æ›²ç‡å…³é”®ç‚¹

### 3. åŠ¨æ€è·¯å¾„ç‚¹åˆ†é…

æ ¹æ®ç¯å¢ƒå¤æ‚åº¦è‡ªé€‚åº”è°ƒæ•´è·¯å¾„ç‚¹æ•°é‡ï¼ˆ7-10ä¸ªï¼‰ï¼š
- ä½å¤æ‚åº¦ç¯å¢ƒï¼š7ä¸ªè·¯å¾„ç‚¹
- é«˜å¤æ‚åº¦ç¯å¢ƒï¼š10ä¸ªè·¯å¾„ç‚¹

### 4. åˆ†æ®µä¸‰æ¬¡è´å¡å°”æ›²çº¿

**å…¬å¼**ï¼š
```
B(u) = Î£(n,i=0) (n choose i)(1-u)^(n-i)u^i P_i
```

**è¿ç»­æ€§çº¦æŸ**ï¼š
- Câ°è¿ç»­ï¼šB(1, v) = B(0, v+1)
- CÂ¹è¿ç»­ï¼šB'(1, v) = B'(0, v+1)
- CÂ²è¿ç»­ï¼šB''(1, v) = B''(0, v+1)

### 5. å¤šç›®æ ‡ä¼˜åŒ–

**æˆæœ¬å‡½æ•°**ï¼š
```
J_cost(p) = w1Â·Safety(p) + w2Â·Smoothness(p)
```

**å®‰å…¨æ€§è¯„åˆ†**ï¼š
```
Safety(p) = -min(MinDis(p_i, p_{i+1}, O_j))
```

**å¹³æ»‘åº¦è¯„åˆ†**ï¼š
```
Smoothness(p) = 1/n Î£|Angle[p_i, p_{i+1}, p_{i+2}]|
```

---

## ğŸ“Š åœºæ™¯é…ç½®æ ¼å¼

åˆ›å»ºJSONæ–‡ä»¶å®šä¹‰åœºæ™¯ï¼š

```json
{
  "name": "è‡ªå®šä¹‰åœºæ™¯",
  "description": "åœºæ™¯æè¿°",
  "start": {"x": 5, "y": 5},
  "goal": {"x": 95, "y": 95},
  "environment": {
    "width": 100,
    "height": 100,
    "resolution": 0.5
  },
  "obstacles": [
    {
      "type": "rectangle",
      "vertices": [[20, 20], [20, 40], [40, 40], [40, 20]]
    },
    {
      "type": "circle",
      "center": [60, 60],
      "radius": 8
    }
  ],
  "parameters": {
    "w1": 0.6,
    "w2": 0.4,
    "safety_margin": 2.0,
    "curvature_threshold": 0.1,
    "max_iterations": 50
  }
}
```

---

## ğŸ¯ å‚æ•°è¯´æ˜

### æ ¸å¿ƒå‚æ•°

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ | èŒƒå›´ |
|------|------|--------|------|
| `w1` | å®‰å…¨æ€§æƒé‡ | 0.6 | 0.0-1.0 |
| `w2` | å¹³æ»‘æ€§æƒé‡ | 0.4 | 0.0-1.0 |
| `safety_margin` | å®‰å…¨è£•åº¦(m) | 2.0 | 0.5-5.0 |
| `curvature_threshold` | æ›²ç‡é˜ˆå€¼ | 0.1 | 0.01-0.5 |
| `max_iterations` | æœ€å¤§è¿­ä»£æ¬¡æ•° | 50 | 10-100 |

### é¢„è®¾æ¨¡å¼

**å®‰å…¨ä¼˜å…ˆ**ï¼š
```bash
--w1 0.7 --w2 0.3 --safety-margin 2.5
```

**å¹³æ»‘ä¼˜å…ˆ**ï¼š
```bash
--w1 0.4 --w2 0.6 --safety-margin 1.5
```

**å¹³è¡¡æ¨¡å¼**ï¼ˆé»˜è®¤ï¼‰ï¼š
```bash
--w1 0.6 --w2 0.4 --safety-margin 2.0
```

---

## ğŸ“ˆ æ€§èƒ½æµ‹è¯•ç»“æœ

### æµ‹è¯•ç¯å¢ƒ

- CPU: Intel CORE i7
- RAM: 16 GB
- Python: 3.11.0

### æ‰¹é‡æµ‹è¯•ç»“æœ

| åœºæ™¯ | å®‰å…¨è·ç¦»(m) | å¹³æ»‘åº¦(Â°) | è·¯å¾„é•¿åº¦(m) | è®¡ç®—æ—¶é—´(s) |
|------|-------------|-----------|-------------|-------------|
| ç¤ºä¾‹1 - ä¸­ç­‰å¤æ‚åº¦ | 2.34 | 159.19 | 138.24 | 1.60 |
| ç¤ºä¾‹2 - é«˜éšœç¢ç‰©å¯†åº¦ | 0.04 | 164.40 | 134.97 | 1.01 |
| ç¤ºä¾‹3 - ç®€å•ç¯å¢ƒ | 1.54 | 158.10 | 126.52 | 1.51 |
| **å¹³å‡** | **1.31** | **160.56** | **133.24** | **1.37** |

---

## ğŸ”Œ APIæœåŠ¡ï¼ˆå¯é€‰ï¼‰

å¯åŠ¨Flask APIæœåŠ¡å™¨ï¼š

```bash
python3 app.py
```

### APIç«¯ç‚¹

#### 1. è·¯å¾„è§„åˆ’
```
POST /api/v1/plan
Content-Type: application/json

{
  "start": {"x": 5, "y": 5},
  "goal": {"x": 95, "y": 95},
  "obstacles": [...],
  "environment": {...},
  "parameters": {...}
}
```

#### 2. ç¯å¢ƒåˆ†æ
```
POST /api/v1/analyze-environment
Content-Type: application/json

{
  "obstacles": [...],
  "environment": {...}
}
```

#### 3. å‚æ•°å»ºè®®
```
POST /api/v1/suggest-parameters
Content-Type: application/json

{
  "scenario": "indoor_navigation",
  "robot_type": "differential_drive",
  "priority": "safety"
}
```

---

## ğŸ› ï¸ é«˜çº§ç”¨æ³•

### 1. Pythonè„šæœ¬é›†æˆ

```python
from dwapcbc import DWAPCBCPlanner, DWAPCBCConfig

# åˆ›å»ºé…ç½®
config = DWAPCBCConfig(
    environment_width=100,
    environment_height=100,
    w1_safety=0.6,
    w2_smoothness=0.4
)

# åˆ›å»ºè§„åˆ’å™¨
planner = DWAPCBCPlanner(config)

# è®¾ç½®éšœç¢ç‰©
obstacles = [
    {'type': 'rectangle', 'vertices': [[20, 20], [20, 40], [40, 40], [40, 20]]},
    {'type': 'circle', 'center': [60, 60], 'radius': 8}
]
planner.set_obstacles(obstacles)

# æ‰§è¡Œè§„åˆ’
result = planner.plan((5, 5), (95, 95))

if result.success:
    print(f"å®‰å…¨è·ç¦»: {result.safety_distance:.2f} m")
    print(f"å¹³æ»‘åº¦: {result.smoothness:.2f}Â°")
    print(f"è·¯å¾„é•¿åº¦: {result.path_length:.2f} m")
```

### 2. è‡ªå®šä¹‰éšœç¢ç‰©ç±»å‹

æ”¯æŒçš„éšœç¢ç‰©ç±»å‹ï¼š
- **çŸ©å½¢**ï¼š`rectangle` - éœ€è¦4ä¸ªé¡¶ç‚¹
- **åœ†å½¢**ï¼š`circle` - éœ€è¦åœ†å¿ƒå’ŒåŠå¾„
- **å¤šè¾¹å½¢**ï¼š`polygon` - éœ€è¦é¡¶ç‚¹åˆ—è¡¨

### 3. æ‰¹é‡åœºæ™¯ç”Ÿæˆ

```python
import json

# ç”Ÿæˆå¤šä¸ªåœºæ™¯
for i in range(10):
    scenario = {
        "name": f"è‡ªåŠ¨ç”Ÿæˆåœºæ™¯{i}",
        "start": {"x": 5, "y": 5},
        "goal": {"x": 95, "y": 95},
        "obstacles": generate_random_obstacles(),
        "environment": {"width": 100, "height": 100, "resolution": 0.5}
    }
    
    with open(f'scenarios/auto_{i}.json', 'w') as f:
        json.dump(scenario, f, indent=2)
```

---

## ğŸ“š ç†è®ºèƒŒæ™¯

æœ¬ç³»ç»ŸåŸºäºä»¥ä¸‹ç ”ç©¶æˆæœï¼š

**è®ºæ–‡**ï¼šJaved Ahmad, Mohd Nadhir Ab Wahab (2025). "Enhancing the safety and smoothness of path planning through an integration of Dijkstra's algorithm and piecewise cubic Bezier optimization". Expert Systems With Applications, 289, 128315.

**å…³é”®åˆ›æ–°**ï¼š
1. åŠ¨æ€è·¯å¾„ç‚¹åˆ†é…ç­–ç•¥ï¼ˆDWAï¼‰
2. åˆ†æ®µä¸‰æ¬¡è´å¡å°”æ›²çº¿ä¼˜åŒ–ï¼ˆPCBCï¼‰
3. è‡ªé€‚åº”å®‰å…¨é—´éš™æœºåˆ¶
4. å¤šç›®æ ‡è¿­ä»£ä¼˜åŒ–

**æ€§èƒ½æå‡**ï¼ˆç›¸æ¯”ä¼ ç»Ÿæ–¹æ³•ï¼‰ï¼š
- å®‰å…¨è·ç¦»æå‡ï¼š**79%**
- å¹³æ»‘åº¦æå‡ï¼š**32%**

---

## ğŸ¤ åº”ç”¨åœºæ™¯

1. **ç§»åŠ¨æœºå™¨äººå¯¼èˆª**
   - å®¤å†…æœåŠ¡æœºå™¨äºº
   - ä»“å‚¨ç‰©æµAGV
   - æ¸…æ´æœºå™¨äºº

2. **è‡ªåŠ¨é©¾é©¶è½¦è¾†**
   - å›­åŒºè‡ªåŠ¨é©¾é©¶
   - åœè½¦åœºå¯¼èˆª
   - ä½é€Ÿæ— äººè½¦

3. **æ— äººæœºè·¯å¾„è§„åˆ’**
   - å®¤å†…æ— äººæœº
   - é¿éšœé£è¡Œ
   - å·¡æ£€è·¯å¾„

4. **å·¥ä¸šè‡ªåŠ¨åŒ–**
   - å·¥å‚AGV
   - è‡ªåŠ¨åŒ–ä»“åº“
   - ç”Ÿäº§çº¿ç‰©æµ

5. **å†œä¸šæœºå™¨äºº**
   - å†œç”°å·¡æ£€
   - ç²¾å‡†ä½œä¸š
   - è‡ªåŠ¨æ”¶å‰²

---

## ğŸ” æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

**Q: è·¯å¾„è§„åˆ’å¤±è´¥ï¼Œæç¤º"æ— æ³•æ‰¾åˆ°æœ‰æ•ˆè·¯å¾„"**

A: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
- èµ·ç‚¹å’Œç»ˆç‚¹æ˜¯å¦åœ¨éšœç¢ç‰©å†…éƒ¨
- å®‰å…¨è£•åº¦æ˜¯å¦è¿‡å¤§ï¼Œå¯¼è‡´æ— å¯è¡Œè·¯å¾„
- éšœç¢ç‰©æ˜¯å¦å®Œå…¨å°é—­äº†è·¯å¾„

**Q: å®‰å…¨è·ç¦»è¿‡å°**

A: å°è¯•ä»¥ä¸‹æ–¹æ³•ï¼š
- å¢åŠ `safety_margin`å‚æ•°
- æé«˜`w1`æƒé‡ï¼ˆå®‰å…¨æ€§ä¼˜å…ˆï¼‰
- å‡å°‘éšœç¢ç‰©å¯†åº¦

**Q: è·¯å¾„ä¸å¤Ÿå¹³æ»‘**

A: è°ƒæ•´å‚æ•°ï¼š
- æé«˜`w2`æƒé‡ï¼ˆå¹³æ»‘æ€§ä¼˜å…ˆï¼‰
- é™ä½`curvature_threshold`
- å¢åŠ è·¯å¾„ç‚¹æ•°é‡

---

## ğŸ“ å¼€å‘è®¡åˆ’

- [x] æ ¸å¿ƒç®—æ³•å®ç°
- [x] å‘½ä»¤è¡Œå·¥å…·
- [x] æ‰¹é‡æµ‹è¯•åŠŸèƒ½
- [x] å¯è§†åŒ–è¾“å‡º
- [ ] åŠ¨æ€éšœç¢ç‰©æ”¯æŒ
- [ ] å®æ—¶è·¯å¾„æ›´æ–°
- [ ] GPUåŠ é€Ÿ
- [ ] ROSé›†æˆ

**æœ€åæ›´æ–°**ï¼š2025å¹´10æœˆ

**ç‰ˆæœ¬**ï¼šv1.0.0

